<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Kaspi Orders — Dashboard</title>
  <link rel="stylesheet" href="/ui/assets/css/theme.css"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <h1>Kaspi Orders — Dashboard</h1>
      <div>
        <button class="btn" id="themeBtn">Тема</button>
      </div>
    </header>

    <div class="controls">
      <button class="btn preset" data-mode="created">Пришло сегодня</button>
      <button class="btn preset" data-mode="planned">План на сегодня</button>
      <button class="btn preset" data-mode="delivered">Доставлено</button>
      <button class="btn preset" data-mode="kaspi_pack">Kaspi: Упаковка (до cut-off)</button>
    </div>

    <form id="form" class="controls">
      <label>Начало <input id="start" type="date" required></label>
      <label>Конец <input id="end" type="date" required></label>
      <label>до времени <input id="end_time" placeholder="например 20:00"></label>
      <label>State(ы) <input id="states" placeholder="например KASPI_DELIVERY"></label>
      <label><input type="checkbox" id="excCanceled" checked> Исключить отменённые</label>
      <label>Дата по полю <input id="date_field" placeholder="creationDate"></label>
      <label><input type="checkbox" id="useCutoff"> Режим cut-off</label>
      <label>Cut-off <input id="cutoff" placeholder="20:00"></label>
      <label>Lookback (дней) <input id="lookback" type="number" min="1" value="3" style="width:70px"></label>
      <button class="btn primary" type="submit">Показать</button>
    </form>

    <div id="kpis" class="kpis"></div>

    <section class="panel">
      <h2>Динамика</h2>
      <div class="chartbox"><canvas id="trend"></canvas></div>
    </section>

    <section class="grid2">
      <div class="panel">
        <h2>Заказы по дням</h2>
        <div class="chartbox"><canvas id="count"></canvas></div>
      </div>
      <div class="panel">
        <h2>Топ городов</h2>
        <div class="chartbox"><canvas id="cities"></canvas></div>
      </div>
    </section>

    <section class="panel">
      <h2>Состояния (диагностика)</h2>
      <div id="tbl-states"></div>
    </section>

    <section class="panel">
      <div class="flexrow">
        <h2>Номера заказов (для сверки)</h2>
        <div class="actions">
          <a class="btn" id="csvLink" download>Скачать CSV</a>
        </div>
      </div>
      <div id="idsTable"></div>
    </section>

    <section class="panel">
      <h2>Таблица: Дни</h2>
      <div id="tbl-days"></div>
    </section>
  </div>
  <script type="module" src="/ui/assets/js/app.js"></script>
</body>
</html>
